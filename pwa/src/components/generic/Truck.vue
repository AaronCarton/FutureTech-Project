<template>
  <svg ref="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 545 759.48">
    <g id="Truck">
      <rect
        x="20.8"
        y="2.5"
        width="503.39"
        height="754.48"
        rx="12"
        ry="12"
        class="stroke-5 fill-white stroke-neutral-700"
      />
      <g>
        <rect
          x="2.5"
          y="64.49"
          width="5"
          height="119"
          rx="1"
          ry="1"
          class="stroke-5 fill-neutral-700 stroke-neutral-700"
        />
        <rect
          x="2.5"
          y="559.49"
          width="5"
          height="119"
          rx="1"
          ry="1"
          class="stroke-5 fill-neutral-700 stroke-neutral-700"
        />
      </g>
      <g>
        <rect
          x="537.5"
          y="64.49"
          width="5"
          height="119"
          rx="1"
          ry="1"
          transform="translate(1080 247.98) rotate(-180)"
          class="stroke-5 fill-neutral-700 stroke-neutral-700"
        />
        <rect
          x="537.5"
          y="559.49"
          width="5"
          height="119"
          rx="1"
          ry="1"
          transform="translate(1080 1237.98) rotate(-180)"
          class="stroke-5 fill-neutral-700 stroke-neutral-700"
        />
      </g>
    </g>
    <g class="slot" data-name="slot 0">
      <path
        d="m23.5,585.49h83v74c0,4.97-4.03,9-9,9H23.5v-83h0Z"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 631.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">0</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 1">
      <rect
        x="23.5"
        y="502.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 548.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">1</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 2">
      <rect
        x="23.5"
        y="419.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 465.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">2</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 3">
      <rect
        x="23.5"
        y="336.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 382.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">3</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 4">
      <rect
        x="23.5"
        y="253.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 299.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">4</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 5">
      <rect
        x="23.5"
        y="170.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 216.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">5</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 6">
      <rect
        x="23.5"
        y="88.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 134.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">6</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 7">
      <path
        d="m32.5,5.49h74v83H23.5V14.49c0-4.97,4.03-9,9-9Z"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(61.92 51.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">7</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 8">
      <rect
        x="106.5"
        y="5.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(144.92 51.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">8</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 9">
      <rect
        x="189.5"
        y="5.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(227.92 51.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">9</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 10">
      <rect
        x="272.5"
        y="5.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(307.84 51.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">10</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 11">
      <rect
        x="355.5"
        y="5.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(390.84 51.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">11</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 12">
      <path
        d="m438.5,5.49h83v83h-74c-4.97,0-9-4.03-9-9V5.49h0Z"
        transform="translate(960 93.98) rotate(180)"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 51.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">12</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 13">
      <rect
        x="438.5"
        y="88.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 134.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">13</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 14">
      <rect
        x="438.5"
        y="171.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 217.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">14</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 15">
      <rect
        x="438.5"
        y="254.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 300.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">15</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 16">
      <rect
        x="438.5"
        y="337.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 383.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">16</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 17">
      <rect
        x="438.5"
        y="420.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 466.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">17</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 18">
      <rect
        x="438.5"
        y="503.49"
        width="83"
        height="83"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.84 549.25)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">18</tspan>
      </text>
    </g>
    <g class="slot" data-name="slot 19">
      <path
        d="m438.5,586.49h83v83h-74c-4.97,0-9-4.03-9-9v-74h0Z"
        class="fill-white stroke-neutral-700 stroke-1"
      />
      <text
        transform="translate(473.17 631.95)"
        style="font-family: MyriadPro-Regular, 'Myriad Pro'; font-size: 12px"
      >
        <tspan x="-12" y="0">19</tspan>
      </text>
    </g>
  </svg>
</template>
<script lang="ts">
import { ref, watch } from 'vue'
import { Parcel } from '../../interfaces/parcel.interface'

export default {
  props: {
    slots: {
      type: Array as () => Parcel[],
      required: true,
    },
    onClick: {
      type: Function,
      required: true,
    },
  },

  setup({ slots, onClick }) {
    enum slotIDs {
      'slot_0' = 0,
      'slot_1' = 1,
      'slot_2' = 2,
      'slot_3' = 3,
      'slot_4' = 4,
      'slot_5' = 5,
      'slot_6' = 6,
      'slot_7' = 7,
      'slot_8' = 8,
      'slot_9' = 9,
      'slot_10' = 10,
      'slot_11' = 11,
      'slot_12' = 12,
      'slot_13' = 13,
      'slot_14' = 14,
      'slot_15' = 15,
      'slot_16' = 16,
      'slot_17' = 17,
      'slot_18' = 18,
      'slot_19' = 19,
    }

    const svg = ref<HTMLElement>()
    //create a for loop where you can loop through the slots in svg and add the number of this slot to the slot object
    //then you can use the slot number to highlight the slot

    watch(svg, (val) => {
      console.log(val)
      if (!val) return

      populateSlots()
    })

    watch(slots, (val) => {
      console.log('new value', val)
      if (!val) return

      populateSlots()
    })

    const populateSlots = () => {
      if (slots.length === 0) return
      const slot = svg.value?.querySelectorAll(`.slot`)!
      for (let i = 0; i < slot.length; i++) {
        console.log(slot[i])
        let slotSelect = slot[i].querySelector('tspan')
        console.log('slotSelect', slots[i])

        if (slotSelect) slotSelect.textContent = slots[i].id
        slot[i].addEventListener('click', () => {
          onClick(slotSelect?.textContent)
        })
      }
    }

    return {
      svg,
    }
  },
}
</script>
